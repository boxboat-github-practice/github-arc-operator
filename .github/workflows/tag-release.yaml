name: Tag Release 

on:
  pull_request:
    types: [closed]
    branches:
      - main

jobs:
  tag:
    if: (github.event.pull_request.merged == true)
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v3
    - run: |
      VERSION=$(git tag -l -n1 --format="%(refname:strip=2)" | tail -n1)
      VERSION=$(awk -F. '/[0-9]+\./{$(NF-1)++;print}' OFS=. <<< "$VERSION")
      git tag $VERSION
      git push --tags
